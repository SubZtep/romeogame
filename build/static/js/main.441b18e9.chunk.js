(window.webpackJsonprgb=window.webpackJsonprgb||[]).push([[0],{14:function(e,n,t){e.exports=t(28)},25:function(e,n){},26:function(e,n){},27:function(e,n){},28:function(e,n,t){"use strict";t.r(n);var i,o,r,a,c,s,u,l=t(1),d=t.n(l),f=t(12),h=t.n(f),p=t(5),v=t.n(p),w=t(7),m=t(4),g=t(6),y=t(13),k=t.n(y),b=function(e){return[e.x,e.y]},E=function(e){var n,t=e.pointRadius,i=void 0===t?3:t,o=e.minPartConfidence,r=void 0===o?.5:o,a=e.scale,c=void 0===a?1:a,s=e.skeletonColor,u=void 0===s?"#ffadea":s,d=e.skeletonLineWidth,f=void 0===d?6:d,h=l.useRef(null);return l.useEffect((function(){if(0!==e.keypoints.length){if(!n){if(null===h.current)return;n=h.current.getContext("2d")}n.clearRect(0,0,e.width,e.height),e.keypoints.forEach((function(e){if(e.score>=r){var t=e.position,o=t.x,a=t.y;n.beginPath(),n.arc(o*c,a*c,i,0,2*Math.PI),n.fillStyle=u,n.fill()}})),g.a(e.keypoints,r).forEach((function(e){!function(e,n,t,i,o,r){var a=Object(m.a)(e,2),c=a[0],s=a[1],u=Object(m.a)(n,2),l=u[0],d=u[1];r.beginPath(),r.moveTo(c*o,s*o),r.lineTo(l*o,d*o),r.lineWidth=i,r.strokeStyle=t,r.stroke()}(b(e[0].position),b(e[1].position),u,f,c,n)}))}}),[e.keypoints]),l.createElement("canvas",{ref:h,width:e.width,height:e.height,className:"absolute"})},x=t(2),P=function(e,n,t,s){e[0].scaling=new x.Vector3(.1,.1,.1),r=e[0],a=t[0],o=x.MeshBuilder.CreateSphere("",{diameter:1e-4},c),i=new x.BoneLookController(r,a.bones[7],o.position,{adjustYaw:.5*Math.PI,adjustRoll:.5*Math.PI})},R=function(){s||(s=new x.Engine(u,!0),function(e){var n=e.canvas,t=e.scene,i=e.engine,o=new x.FreeCamera("camera1",new x.Vector3(0,5,11),t);o.setTarget(new x.Vector3(0,3.5,0)),o.attachControl(n,!0),new x.HemisphericLight("light1",new x.Vector3(0,1,0),t),x.SceneLoader.ImportMesh("him","/models/Dude/","dude.babylon",t,P),i.runRenderLoop((function(){t&&t.render()}))}({scene:c=new x.Scene(s),engine:s,canvas:u}))},j=function(){s&&s.resize()},C=function(e){e.width,e.height;l.useEffect((function(){return R(),window.addEventListener("resize",j),function(){window.removeEventListener("resize",j)}}),[]),l.useEffect((function(){e.keypoints&&e.keypoints.length>0&&function(e){var n=e.find((function(e){return"nose"===e.part})).position,t=a.bones[7];c.registerBeforeRender((function(){o.position.x=t.position.x+Math.round((320-n.x)/20),o.position.y=t.position.x+Math.round((240-n.y)/20),o.position.z=6,i.update()}))}(e.keypoints)}),[e.keypoints]);var n={width:e.width,height:e.height};return l.createElement("canvas",Object.assign({},n,{ref:function(e){null!==e&&(u=e)}}))},M=function(e){var n,t=e.videoWidth,i=void 0===t?640:t,o=e.videoHeight,r=void 0===o?480:o,a=e.flipHorizontal,c=void 0===a||a,s=e.minPoseConfidence,u=void 0===s?.1:s,d=l.useRef(null),f=l.useState([]),h=Object(m.a)(f,2),p=h[0],y=h[1],b=function(){var e=Object(w.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.b({architecture:"ResNet50",outputStride:32,inputResolution:257,quantBytes:2,multiplier:1});case 3:n=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error("PoseNet failed to load");case 9:x();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=d.current.video;e.width=i,e.height=r;var t=function(){var i=Object(w.a)(v.a.mark((function i(){var o;return v.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.estimateSinglePose(e,{flipHorizontal:c});case 2:(o=i.sent).score>=u&&y(o.keypoints),requestAnimationFrame(t);case 5:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();t()};return l.createElement("div",{className:"flex"},l.createElement("div",{className:"relative",style:{width:i,height:r}},l.createElement(k.a,{audio:!1,mirrored:!0,onUserMedia:b,ref:d,className:"absolute"}),l.createElement(E,{width:i,height:r,keypoints:p})),l.createElement(C,{width:i,height:r,keypoints:p}))},S=function(){return l.createElement("div",{className:"container mx-auto bg-gray-100"},l.createElement(M,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));h.a.render(d.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[14,1,2]]]);
//# sourceMappingURL=main.441b18e9.chunk.js.map